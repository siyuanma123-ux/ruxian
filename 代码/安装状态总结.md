# End-to-endæ¨¡å‹å®‰è£…çŠ¶æ€æ€»ç»“

## âœ… å·²å®Œæˆ

1. **æ¨¡å‹ä»£ç **: âœ… å·²ä¸‹è½½åˆ° `pretrained_models/end-to-end_all_convolutional_design/`
2. **Keras 2.0.8**: âœ… å·²å®‰è£…
3. **åŸºç¡€ä¾èµ–**: âœ… å·²å®‰è£…ï¼ˆh5py, scipy, pillow, opencv-python, pandasï¼‰
4. **æƒé‡ç›®å½•**: âœ… å·²åˆ›å»º `pretrained_models/end-to-end_all_convolutional_design/weights/`
5. **è¯Šæ–­è„šæœ¬**: âœ… å·²åˆ›å»º `diagnose_with_high_accuracy_model.py`

## âŒ æœªå®Œæˆ

1. **TensorFlow 1.15.0**: âŒ æ— æ³•å®‰è£…ï¼ˆéœ€è¦Python 3.7ï¼Œå½“å‰æ˜¯Python 3.9ï¼‰
2. **é¢„è®­ç»ƒæƒé‡**: âŒ æœªä¸‹è½½ï¼ˆéœ€è¦ä»Google Driveæ‰‹åŠ¨ä¸‹è½½ï¼‰

## ğŸ”§ è§£å†³æ–¹æ¡ˆ

### å¿…é¡»æ“ä½œï¼šåˆ›å»ºPython 3.7ç¯å¢ƒ

ç”±äºTensorFlow 1.15.0ä¸æ”¯æŒPython 3.9ï¼Œ**å¿…é¡»**ä½¿ç”¨Python 3.7ç¯å¢ƒã€‚

#### æ–¹æ³•1: ä½¿ç”¨condaï¼ˆæ¨èï¼‰â­

```bash
# 1. åˆ›å»ºPython 3.7ç¯å¢ƒ
conda create -n end2end python=3.7 -y

# 2. æ¿€æ´»ç¯å¢ƒ
conda activate end2end

# 3. å®‰è£…æ‰€æœ‰ä¾èµ–
pip install keras==2.0.8
pip install tensorflow==1.15.0
pip install h5py scipy pillow opencv-python pandas "numpy<1.20"

# 4. éªŒè¯å®‰è£…
python -c "import keras; import tensorflow as tf; print('âœ… Keras:', keras.__version__); print('âœ… TensorFlow:', tf.__version__)"
```

#### æ–¹æ³•2: ä½¿ç”¨pyenv

```bash
# 1. å®‰è£…pyenvï¼ˆå¦‚æœæœªå®‰è£…ï¼‰
brew install pyenv

# 2. å®‰è£…Python 3.7
pyenv install 3.7.16

# 3. åœ¨é¡¹ç›®ç›®å½•è®¾ç½®Pythonç‰ˆæœ¬
cd /Users/masiyuan/Desktop/ä¹³è…ºç™Œ
pyenv local 3.7.16

# 4. å®‰è£…ä¾èµ–
pip install keras==2.0.8 tensorflow==1.15.0 h5py scipy pillow opencv-python pandas "numpy<1.20"
```

### å¿…é¡»æ“ä½œï¼šä¸‹è½½é¢„è®­ç»ƒæƒé‡

1. **è®¿é—®Google Drive**:
   ```
   https://drive.google.com/drive/folders/0B1PVLadG_dCKV2pZem5MTjc1cHc
   ```

2. **æ¨èä¸‹è½½**:
   - **INbreast VGG16 [512-512-1024]x2** (AUC 0.95-0.96) â­ æœ€é«˜å‡†ç¡®ç‡
   - **DDSM Resnet50 [512-512-1024]x2** (AUC 0.86-0.91)

3. **ä¿å­˜ä½ç½®**:
   ```bash
   # å°†ä¸‹è½½çš„.h5æ–‡ä»¶æ”¾åˆ°è¿™ä¸ªç›®å½•
   pretrained_models/end-to-end_all_convolutional_design/weights/
   ```

## ğŸš€ å®Œæ•´å®‰è£…æµç¨‹

### æ­¥éª¤1: åˆ›å»ºcondaç¯å¢ƒ

```bash
conda create -n end2end python=3.7 -y
conda activate end2end
```

### æ­¥éª¤2: å®‰è£…ä¾èµ–

```bash
pip install keras==2.0.8 tensorflow==1.15.0 h5py scipy pillow opencv-python pandas "numpy<1.20"
```

### æ­¥éª¤3: ä¸‹è½½æƒé‡

ä»Google Driveä¸‹è½½æƒé‡æ–‡ä»¶åˆ° `pretrained_models/end-to-end_all_convolutional_design/weights/`

### æ­¥éª¤4: éªŒè¯å®‰è£…

```bash
python -c "
import keras
import tensorflow as tf
import os

print('âœ… Kerasç‰ˆæœ¬:', keras.__version__)
print('âœ… TensorFlowç‰ˆæœ¬:', tf.__version__)

# æ£€æŸ¥æƒé‡æ–‡ä»¶
weights_dir = 'pretrained_models/end-to-end_all_convolutional_design/weights'
if os.path.exists(weights_dir):
    weights = [f for f in os.listdir(weights_dir) if f.endswith('.h5')]
    if weights:
        print('âœ… æ‰¾åˆ°æƒé‡æ–‡ä»¶:', weights)
    else:
        print('âš ï¸  æƒé‡ç›®å½•å­˜åœ¨ä½†æœªæ‰¾åˆ°.h5æ–‡ä»¶')
else:
    print('âš ï¸  æƒé‡ç›®å½•ä¸å­˜åœ¨')
"
```

### æ­¥éª¤5: è¿è¡Œè¯Šæ–­

```bash
cd ä»£ç 
python diagnose_with_high_accuracy_model.py \
    --mammo_dir "../é’¼é¶æŠ¥å‘Š" \
    --output_dir "../æœªå‘½åæ–‡ä»¶å¤¹ 2" \
    --end2end_model "../pretrained_models/end-to-end_all_convolutional_design/weights/inbreast_vgg16_[512-512-1024]x2.h5"
```

## ğŸ“‹ å¿«é€Ÿæ£€æŸ¥æ¸…å•

åœ¨è¿è¡Œè¯Šæ–­ä¹‹å‰ï¼Œè¯·ç¡®è®¤ï¼š

- [ ] condaç¯å¢ƒå·²åˆ›å»ºå¹¶æ¿€æ´»ï¼ˆPython 3.7ï¼‰
- [ ] Keras 2.0.8å·²å®‰è£…
- [ ] TensorFlow 1.15.0å·²å®‰è£…
- [ ] é¢„è®­ç»ƒæƒé‡æ–‡ä»¶å·²ä¸‹è½½åˆ°weightsç›®å½•
- [ ] å¯ä»¥æˆåŠŸå¯¼å…¥keraså’Œtensorflow

## ğŸ“ ç›¸å…³æ–‡ä»¶

- **å®‰è£…è„šæœ¬**: `ä»£ç /install_end2end_model.py`
- **å¿«é€Ÿå®‰è£…è„šæœ¬**: `ä»£ç /å¿«é€Ÿå®‰è£…End2Endæ¨¡å‹.sh`
- **å®Œæ•´å®‰è£…æŒ‡å—**: `ä»£ç /å®Œæ•´å®‰è£…æŒ‡å—.md`
- **è¯Šæ–­è„šæœ¬**: `ä»£ç /diagnose_with_high_accuracy_model.py`

## âš ï¸ é‡è¦æç¤º

1. **å¿…é¡»ä½¿ç”¨Python 3.7**: TensorFlow 1.15.0ä¸æ”¯æŒPython 3.9
2. **å»ºè®®ä½¿ç”¨è™šæ‹Ÿç¯å¢ƒ**: é¿å…ä¸ç°æœ‰ç¯å¢ƒå†²çª
3. **æƒé‡æ–‡ä»¶éœ€è¦æ‰‹åŠ¨ä¸‹è½½**: Google Driveé“¾æ¥éœ€è¦æµè§ˆå™¨è®¿é—®
4. **æ¨¡å‹è¾“å‡ºæ˜¯äºŒåˆ†ç±»**: æ­£å¸¸/å¼‚å¸¸ï¼Œä¸æ˜¯å››åˆ†ç±»

## ğŸ¯ å½“å‰æœ€ä½³æ–¹æ¡ˆ

ç”±äºTensorFlow 1.15.0çš„å®‰è£…é™åˆ¶ï¼Œå»ºè®®ï¼š

1. **çŸ­æœŸæ–¹æ¡ˆ**: ç»§ç»­ä½¿ç”¨PyTorchæ¨¡å‹è¿›è¡Œè¯Šæ–­ï¼ˆå·²å®Œæˆï¼‰
2. **é•¿æœŸæ–¹æ¡ˆ**: åˆ›å»ºcondaç¯å¢ƒï¼Œå®‰è£…å®Œæ•´ä¾èµ–ï¼Œä¸‹è½½æƒé‡ï¼Œä½¿ç”¨End-to-endæ¨¡å‹

å½“å‰PyTorchæ¨¡å‹çš„è¯Šæ–­æŠ¥å‘Šå·²ç”Ÿæˆåœ¨ `æœªå‘½åæ–‡ä»¶å¤¹ 2/` ç›®å½•ä¸­ã€‚


